<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + TS</title>
  </head>
  <body>
    <div id="app"></div>

    <script type="module" src="/src/main.ts"></script>
    <script type="module">
      import { SDK_BASE_URLS, getAccountList, getAccountById, initSDK, totalStaked, amountCanBeStaked } from '/src/main.ts';

      (async () => {
        console.log('SDK_BASE_URLS');
        const keys = Object.keys(SDK_BASE_URLS);
        console.log('keys');
        console.log(keys);
        let title = document.createElement('div');
        title.textContent = 'Chains';
        document.body.appendChild(title);
        keys.forEach((name, i) => {
          const el = document.createElement('input');
          el.setAttribute('type', 'radio');
          el.setAttribute('name', 'chain');
          el.setAttribute('value', name);
          const label = document.createElement('label');
          label.setAttribute('for', name);
          label.textContent = name;
          if (!i) {
            el.setAttribute('checked', 'checked');
          }
          document.body.appendChild(el);
          document.body.appendChild(label);
          document.body.appendChild(document.createElement('br'));
        });

        const accountIds = (await getAccountList()).map(el => (el.id));
        title = document.createElement('div');
        title.textContent = 'Accounts';
        document.body.appendChild(title);
        accountIds.forEach((name, i) => {
          const el = document.createElement('input');
          el.setAttribute('type', 'radio');
          el.setAttribute('name', 'account');
          el.setAttribute('value', name);
          const label = document.createElement('label');
          label.setAttribute('for', name);
          label.textContent = name;
          if (!i) {
            el.setAttribute('checked', 'checked');
          }
          document.body.appendChild(el);
          document.body.appendChild(label);
          document.body.appendChild(document.createElement('br'));
        });

        // buttons
        const getBalanceButton = document.createElement('button')
        getBalanceButton.addEventListener('click', getAccountList);
        getBalanceButton.innerHTML = 'getAccountList';
        document.body.appendChild(getBalanceButton);
        document.body.appendChild(document.createElement('br'));

        const getAccountByIdButton = document.createElement('button')
        getAccountByIdButton.addEventListener('click', () => {
          getAccountById(document.querySelector('input[name="account"]:checked').value)
        });
        getAccountByIdButton.innerHTML = 'getAccountById';
        document.body.appendChild(getAccountByIdButton);
        document.body.appendChild(document.createElement('br'));

        const initSDKButton = document.createElement('button')
        initSDKButton.addEventListener('click', () => {
          initSDK(document.querySelector('input[name="chain"]:checked').value)
        });
        initSDKButton.innerHTML = 'initSDK';
        document.body.appendChild(initSDKButton);
        document.body.appendChild(document.createElement('br'));

        const totalStakedButton = document.createElement('button')
        totalStakedButton.addEventListener('click', async () => {
          const account = await getAccountById(document.querySelector('input[name="account"]:checked').value);
          const nameChain = document.querySelector('input[name="chain"]:checked').value;
          totalStaked(account, undefined, nameChain);
        });
        totalStakedButton.innerHTML = 'totalStaked';
        document.body.appendChild(totalStakedButton);
        document.body.appendChild(document.createElement('br'));

        const amountCanBeStakedButton = document.createElement('button')
        amountCanBeStakedButton.addEventListener('click', async () => {
          const account = await getAccountById(document.querySelector('input[name="account"]:checked').value);
          const nameChain = document.querySelector('input[name="chain"]:checked').value;
          amountCanBeStaked(account, undefined, nameChain);
        });
        amountCanBeStakedButton.innerHTML = 'amountCanBeStaked';
        document.body.appendChild(amountCanBeStakedButton);
        document.body.appendChild(document.createElement('br'));


      })()
    </script>
  </body>
</html>
